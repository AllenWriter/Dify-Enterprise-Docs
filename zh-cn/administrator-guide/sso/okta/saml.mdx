---
title: 使用 SAML 配置 OIDC
version: '简体中文'
---

本篇文档将使用 Okta 作为 SSO 身份提供商，使用 SAML 协议连接至 Dify 企业版。

## 1. 在 Okta 中创建一个新的应用程序

1. 访问 Okta 的管理员后台页，导航到 Applications 页，轻点 Create App Integration 按钮。
![](/zh-cn/img/eac08a1d4b7aa615d1108081b5e99731.png)
2. 然后选择 "SAML 2.0" 应用类型。
![](/zh-cn/img/409f64e068449c2f9dc9c3e471a36946.png)
3. 点击 Next 后，你将被导航至 Configure SAML 页，此部分需要填写部分参数。请稍作等待并打开新的浏览器标签页，遵循下文指引获取必要信息，然后继续填写。

## 2. 配置 Okta 应用程序

系统管理员需要将 Dify 企业版的 Callback URL 填写至 Okta 应用程序内。

1. 点击 Dify 企业版的 Authentication 页，轻点 **"+ New Identity Provider → New SAML Provider"**，然后即可查看 ACS URL。

   ![](/zh-cn/img/f66303a3902d7fff58c76228f6485386.png)

   它通常为以下格式：

   ```
   https://[your-dify-enterprise-url]/console/api/enterprise/sso/saml/acs
   ```

2. 将其粘贴至 Configure SAML 页的 Single sign-on URL 和 Audience URI (SP Entity ID) 字段内。

![](/zh-cn/img/e6c1a1521306919ab325030adafb2d2b.png)

3. 填写 URL 后，继续完成以下设置：
   * 将 Name ID 格式设置为 EmailAddress
   * 在 "Show Advanced Settings" 下，验证响应和断言签名是否被设置为 Signed

4. 轻点 "Next" 按钮完成设置。

## 3. 完成在 Dify 上的配置

1. 先前往 Okta 应用程序的 "Sign On" 页，找到以下信息：
   * Sign-on URL
   * Signing certificate

   ![](/zh-cn/img/edd232ff0c1e0a28243fdce755f8ea1b.png)

2. 接着在 "Assignments" 页分配允许使用 SSO 登录的成员。

   ![](/zh-cn/img/7ce55440e9bce1965712e167ab8e8567.png)

3. 最后回到 Dify 企业版的 Authentication 页，轻点 **"+ New Identity Provider → New SAML Provider"**，然后在页面中依次填写在上文中获取的信息完成配置。

   填写 X509 Signing Certificate 时需参考以下格式：

   ```
   -----BEGIN CERTIFICATE-----
   {certificate}
   -----END CERTIFICATE-----
   ```

   ![](/zh-cn/img/1548ea93cfa68352384295fef8b038e3.png)

## 4. 开启 SSO 强制认证

完成 OIDC Provider 配置后，轻点 **"Workspaces SSO"** 右侧的开关按钮，为你的团队启用 SSO 认证。

启用后，你的组织成员必须完成身份验证后才能访问 Dify 企业版中的资源。
