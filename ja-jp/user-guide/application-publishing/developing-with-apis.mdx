---
title: API に基づく開発
version: '日本語'
---

Dify は「**後端即サービス(Backend as a Service)**」の理念に基づいてすべてのアプリケーションに API を提供し、AI アプリケーション開発者に多くの利便性をもたらします。この理念により、開発者は複雑なバックエンドアーキテクチャやデプロイメントプロセスを気にすることなく、フロントエンドアプリケーションで大規模言語モデルの強力な能力を直接取得できます。

#### Dify API を使用する利点

* フロントエンドアプリケーションが LLM 能力を直接安全に呼び出し、バックエンドサービスの開発プロセスを省くことができます
* ビジュアルインターフェースでアプリケーションを設計し、すべてのクライアントでリアルタイムに反映されます
* LLM プロバイダーの基本機能をうまくカプセル化しています
* LLM プロバイダーを随時切り替え、LLM のキーを集中管理します
* ビジュアルインターフェースでアプリケーションを運営し、ログの分析、ラベル付け、ユーザーのアクティビティの監視などを行います
* アプリケーションに対して、より多くのツール機能、プラグイン機能、データセットを継続的に提供します

#### 使用方法

アプリケーションを選択し、アプリケーション（Apps）の左側ナビゲーションで **API アクセス（API Access）** を見つけることができます。このページで Dify が提供する API ドキュメントを確認し、API にアクセスするための資格情報を管理できます。

<Frame>
    <img src="../../img/API Access.png" alt="" />
</Frame>

例えば、あなたがコンサルティング会社の開発部門である場合、会社のプライベートデータベースに基づいてエンドユーザーや開発者に AI 能力を提供できますが、開発者はあなたのデータや AI ロジック設計を把握することはできません。これにより、サービスは安全かつ持続可能に提供され、商業目的を満たすことができます。

<Info>
ベストプラクティスでは、API キーはバックエンド呼び出しを通じて行うべきであり、フロントエンドコードやリクエストに平文で露出させるべきではありません。これにより、アプリケーションが悪用されたり攻撃されたりするのを防ぐことができます。
</Info>

1 つのアプリケーションに対して **複数のアクセス資格情報を作成** し、異なるユーザーや開発者に提供することができます。これにより、APIのユーザーはアプリケーション開発者が提供するAI能力を使用しているにもかかわらず、背後のプロンプトエンジニアリング、データセット、ツール機能はカプセル化されています。

#### テキスト生成型アプリケーション

高品質なテキストを生成するアプリケーションに使用できます。例えば、記事の生成、要約、翻訳などです。completion-messages インターフェースを呼び出し、ユーザー入力を送信して生成されたテキスト結果を取得します。テキスト生成に使用されるモデルパラメータとプロンプトテンプレートは、Dify プロンプトオーケストレーションページの設定に依存します。

**アプリケーション -> API アクセス**で、このアプリケーションの API ドキュメントとサンプルリクエストを見つけることができます。

例えば、テキスト補完情報を作成する API の呼び出し例：

```
curl --location --request POST 'https://api.dify.ai/v1/completion-messages' \
--header 'Authorization: Bearer ENTER-YOUR-SECRET-KEY' \
--header 'Content-Type: application/json' \
--data-raw '{
    "inputs": {},
    "response_mode": "streaming",
    "user": "abc-123"
}'
```

```python
import requests
import json

url = "https://api.dify.ai/v1/completion-messages"

headers = {
    'Authorization': 'Bearer ENTER-YOUR-SECRET-KEY',
    'Content-Type': 'application/json',
}

data = {
    "inputs": {"text": 'Hello, how are you?'},
    "response_mode": "streaming",
    "user": "abc-123"
}

response = requests.post(url, headers=headers, data=json.dumps(data))

print(response.text)
```

### 会話型アプリケーション

大部分のシーンで使用できる会話型アプリケーションは、一問一答形式でユーザーと継続的に会話します。会話を開始するにはchat-messagesエンドポイントを呼び出し、返されたconversation\_idを引き続き提供することで会話を継続することができます。

#### `conversation_id` に関する重要事項:

- **`conversation_id` の生成:** 新しい会話を開始するときは、`conversation_id` フィールドを空のままにしておきます。システムは新しい `conversation_id` を生成して返します。この新しい `conversation_id` は、今後のやり取りで使用して会話を続行します。
- **既存のセッションでの `conversation_id` の処理:** `conversation_id` が生成されると、Dify ボットとの会話の継続性を確保するために、今後の API 呼び出しにこの `conversation_id` を含める必要があります。以前の `conversation_id` が渡されると、新しい `inputs` は無視されます。進行中の会話では `query` のみが処理されます。
- **ダイナミックな変数の管理:** セッション中にロジックまたは変数を変更する必要がある場合は、会話変数 (セッション固有の変数) を使用してボットの動作または応答を調整できます。

**アプリケーション -> APIアクセス**でそのアプリケーションのAPIドキュメントとサンプルリクエストを見つけることができます。

以下は`chat-messages`のAPIの呼び出し例：

```
curl --location --request POST 'https://api.dify.ai/v1/chat-messages' \
--header 'Authorization: Bearer ENTER-YOUR-SECRET-KEY' \
--header 'Content-Type: application/json' \
--data-raw '{
    "inputs": {},
    "query": "eh",
    "response_mode": "streaming",
    "conversation_id": "1c7e55fb-1ba2-4e10-81b5-30addcea2276",
    "user": "abc-123"
}'

```


```python
import requests
import json

url = 'https://api.dify.ai/v1/chat-messages'
headers = {
    'Authorization': 'Bearer ENTER-YOUR-SECRET-KEY',
    'Content-Type': 'application/json',
}
data = {
    "inputs": {},
    "query": "eh",
    "response_mode": "streaming",
    "conversation_id": "1c7e55fb-1ba2-4e10-81b5-30addcea2276",
    "user": "abc-123"
}

response = requests.post(url, headers=headers, data=json.dumps(data))

print(response.json())
```
